# Development version Dockerfile with Rollup fix
FROM node:18-alpine

WORKDIR /app

# Add build dependencies for native modules
RUN apk add --no-cache python3 make g++ build-base

# Copy package.json and package-lock.json
COPY package.json package-lock.json ./

# Force reinstall with specific options to handle rollup issues
RUN rm -rf node_modules && \
    npm install --legacy-peer-deps --no-optional && \
    # Add explicit fix for rollup
    npm install --legacy-peer-deps @rollup/rollup-linux-x64-musl

# Copy configuration files
COPY vite.config.ts tsconfig.json tailwind.config.ts postcss.config.js ./

# Copy source code
COPY . .

# Expose port
EXPOSE 8080

# Start development server
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"] 